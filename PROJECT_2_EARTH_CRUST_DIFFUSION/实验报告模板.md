# 项目2：地壳热扩散数值模拟 - 实验报告

**学生姓名：** [刘睿]

**学号：** [20231050209]

**完成日期：** [2025/6/11]


---

## 1. 实验目的

本实验旨在通过数值方法求解地壳中的热传导方程，深入理解以下概念：

- 时变边界条件对热传导过程的影响
- 显式差分格式的稳定性和精度特点
- 地球科学中的热传导现象

**核心学习目标：**
1. 掌握显式差分格式求解抛物型偏微分方程
2. 理解季节性温度变化在地壳中的传播规律

---

## 2. 理论背景

### 2.1 热传导方程

地壳中的一维热传导方程为：

$$\frac{\partial T}{\partial t} = D \frac{\partial^2 T}{\partial z^2}$$

其中：
- $T(z,t)$ 是温度分布函数
- $z$ 是深度坐标（向下为正）
- $t$ 是时间
- $D$ 是热扩散率

### 2.2 边界条件和初始条件

**边界条件：**
- 地表 ( $z=0$ )： $T(0,t) = A + B\sin(\frac{2\pi t}{\tau})$
- 深层 ( $z=20\text{m}$ )： $T(20,t) = 11°\text{C}$

**初始条件：**
- $T(z,0) = 10°\text{C}$ （除边界点外）

**物理参数：**
- $D = 0.1 \text{ m}^2/\text{day}$ （热扩散率）
- $A = 10°\text{C}$ （年平均地表温度）
- $B = 12°\text{C}$ （地表温度振幅）
- $\tau = 365 \text{ days}$ （年周期）


## 3. 数值方法简述

### 3.1 显式差分格式(或者你采取的其他算法)

**请描述你实现的差分算法的具体形式和求解方法：**

[在此描述你的数值方法实现，包括：]
- 空间和时间离散化方案
- 答：
- 空间离散：将深度范围 \([0, \text{DEPTH\_MAX}]\)（这里 \(\text{DEPTH\_MAX}=20.0\ \text{m}\) ）用空间步长 h 离散，通过 depth = np.arange(0, DEPTH_MAX + h, h) 生成深度数组，共 M 个网格点（代码中默认 \(M = 21\) ），离散后的深度节点为 \(z_i = i \cdot h\) ，\(i = 0, 1, \dots, M - 1\) 。
- 时间离散：模拟总时长由 years （默认 10 年）和 TAU = 365.0 （年周期）确定，总时间步数为 years * TAU ，代码里通过循环 for year in range(years) 结合内部时间步循环实现，时间步长 \(\Delta t\) 与参数 a 相关（代码中 a 实际参与稳定性参数计算，需结合稳定性条件理解其对时间步长的影响 ），离散后的时间节点为 \(t_j = j \cdot \Delta t\) ，\(j = 0, 1, \dots, N - 1\)（N 为时间步数，默认 366 ）。
- 差分方程的具体形式
- 答：
- 一维热传导方程为 \(\frac{\partial T}{\partial t} = D \cdot \frac{\partial^2 T}{\partial z^2}\) 。
显式差分格式对时间导数用向前差分，对空间二阶导数用中心差分近似：时间向前差分：\(\frac{\partial T}{\partial t} \approx \frac{T_i^{j + 1} - T_i^j}{\Delta t}\) ，其中 \(T_i^j\) 表示第 i 个深度节点、第 j 个时间步的温度。空间二阶中心差分：\(\frac{\partial^2 T}{\partial z^2} \approx \frac{T_{i + 1}^j - 2T_i^j + T_{i - 1}^j}{h^2}\) 。代入原方程并整理，得到显式差分更新公式：
\(T_i^{j + 1} = T_i^j + r \cdot (T_{i + 1}^j + T_{i - 1}^j - 2T_i^j)\)
其中 \(r = \frac{D \cdot \Delta t}{h^2}\) （代码中 r = h * D / a**2 ，这里 a 实际对应 \(\Delta t\) 相关表述，需注意参数对应关系 ），i 取 1 到 \(M - 2\)（避开边界节点 ），j 按时间步循环。
- 边界条件的处理方法
- 答：
- 地表（\(z = 0\) ，即 \(i = 0\) ）：为随时间变化的边界，公式为 \(T = A + B \cdot \sin(2\pi t / \tau)\) ，代码中通过 T[0, j] = A + B * np.sin(2 * np.pi * j / TAU) 实现，每个时间步 j 计算对应时刻的地表温度。
- 深度边界（\(z = \text{DEPTH\_MAX}\) ，即 \(i = M - 1\) ）：为固定温度边界，温度值设为 T_BOTTOM = 11.0 °C ，代码里初始化时 T[-1, :] = T_BOTTOM ，整个模拟过程保持该深度温度不变。
- 稳定性条件的考虑
- 答：显式差分格式求解热传导方程是条件稳定的。稳定性参数 \(r = \frac{D \cdot \Delta t}{h^2}\)（代码中 r = h * D / a**2 ，这里要注意代码参数写法与理论公式的对应，实际 r 本质是 \(\frac{D \cdot \Delta t}{h^2}\) ，需保证代码参数传递正确 ），当 \(r \leq \frac{1}{2}\) 时，格式稳定 ；若 \(r > \frac{1}{2}\) ，数值解会出现振荡、发散等不稳定现象。代码中通过计算并打印 r 的值，辅助判断模拟是否满足稳定性要求，实际应用中需合理选择时间步长 \(\Delta t\)（对应代码里与 a 相关的设置 ）和空间步长 h ，使 r 落在稳定区间。

**稳定性分析：**

[讨论显式格式的稳定性特点，包括：]
- 稳定性参数 $r = \frac{hD}{a^2}$ 的值
- 答：理论上热传导显式格式稳定性参数为 \(r = \frac{D \cdot \Delta t}{h^2}\) ，代码中写法 r = h * D / a^2 ，需注意这里的 a 实际对应时间步长相关量（可理解为代码中对时间步长的一种自定义参数化方式 ），本质要满足 \(r \leq \frac{1}{2}\) 才能保证稳定。比如代码运行时会输出计算得到的 r 值，通过该值可直观判断当前参数设置下格式是否可能稳定。
- 时间步长选择的限制条件
- 答：由稳定性条件 \(r = \frac{D \cdot \Delta t}{h^2} \leq \frac{1}{2}\) ，可推导出时间步长 \(\Delta t\) 需满足 \(\Delta t \leq \frac{h^2}{2D}\) 。在代码中，时间步长通过参数 a 等间接控制（需结合代码逻辑明确其与 \(\Delta t\) 的对应关系 ），实际模拟时必须根据空间步长 h 、热扩散率 D ，按照上述不等式限制时间步长，否则若 \(\Delta t\) 过大，导致 \(r > \frac{1}{2}\) ，数值解将不稳定，出现不合理的温度振荡、异常增长等问题，无法正确模拟地壳热扩散过程。

---

## 4. 实验结果

### 4.1 数值结果

**基本计算参数：**
- 网格点数: $n_z$ =  [21]
- 时间步数: $n_t$ =  [366]
- 模拟总时间：[10] 年
- 稳定性参数: $r$ =  [0.1000]

### 4.2 图表结果：季节性温度轮廓图

[在此粘贴季节性温度轮廓图图片]
![image](https://github.com/user-attachments/assets/e395b7b9-3372-4778-85e1-7a0c6ab6a99a)


**图表分析：**
- 描述四个季节温度轮廓的差异
- 答：
- Day 90（蓝线）：地表温度较高，随深度增加快速下降；较浅深度（如 0 - 5m）温度梯度大，深层（10m 后）趋近稳定值。
Day 180（橙线）：地表温度处于中间水平，深度 2 - 8m 温度变化相对平缓，整体曲线更 “平缓过渡”。
Day 270（绿线）：地表温度低，浅部（0 - 5m）温度快速上升，与其他季节浅部温度趋势相反，深层逐渐收敛。
Day 365（红线）：温度曲线形态与 Day 90 有一定相似性，但数值略不同，体现年周期回归特征。
- 分析温度振幅随深度的衰减规律
- 答：地表（0m 处）温度振幅最大（由 \(A + B\sin(\dots)\) 决定，\(B=12\) ）；随深度增加，不同季节温度曲线逐渐靠拢，振幅快速衰减。约 5 - 10m 后，温度波动显著减小；15m 以深，各季节温度几乎重合，振幅趋近于 0 ，符合热扩散 “深度越深，温度波动越弱” 的物理规律。
- 讨论季节性影响的穿透深度
- 答：季节性温度波动主要影响浅部地壳。从图中看，10m 以浅温度随季节有明显变化；15m 左右，各季节温度已接近稳定值（~11°C ，与底部边界一致 ）。可认为季节性影响的有效穿透深度约为 10 - 15m ，超过该深度后，年周期温度波动对其影响可忽略。

---

## 5. 分析与讨论

### 5.1 物理现象分析

**地壳热传导特征：**

[分析模拟结果揭示的物理现象：]
答：地壳热传导特征：
模拟结果揭示地壳热传导的 “衰减性” 与 “滞后性”：
衰减性：地表受季节周期热源（温度正弦波动）驱动，热扰动随深度增加因热扩散逐渐衰减，温度振幅指数级降低（符合热传导方程解析解规律 ）。
滞后性：深层温度变化滞后于地表（如 Day 270 地表温度低，但浅部升温、深部响应慢 ），体现热扩散需时间传递能量，深度越深，响应延迟越明显。

### 5.4 思考题

**请回答以下问题：**

1. **为什么深层温度的季节性变化比地表小得多？这种现象在实际地球科学中有什么应用？**

   [你的回答]
答：
原因：热传导中，温度波动传递需通过分子热运动扩散，深层物质与地表热源的热交换 “路径长、阻力大”，能量传递效率低；同时，深层受周围稳定温度环境（如代码中 20m 深处固定为 11°C ）的 “平均化” 影响，波动被抑制。
应用：
地温监测：利用深层温度稳定特性，可作为长期气候变迁的 “基准参考”（如深层地温变化反映千年尺度气候，不受季节干扰 ）。
地下工程：隧道、矿井等设计中，依赖深层温度稳定特点，规划通风、温控系统（如浅部需考虑季节调温，深部可简化 ）。


3. **显式差分格式相比隐式格式有什么优势？在什么情况下可能选择隐式格式？**

   [你的回答]
答：
1.显式优势：计算简单：时间层更新仅依赖前一时刻数据，无需解方程组，代码实现直观（如本案例直接循环更新 T[1:-1, j+1] ）。计算高效：单步计算复杂度低，适合小规模、对实时性要求不高的模拟（如教学案例、初步探索性模拟 ）。
2.隐式格式选择场景：
强稳定性需求：隐式格式（如 Crank - Nicolson ）无条件稳定（或稳定条件宽松 ），当模拟需大时间步长（如地质长期演化、高 D 场景 ），显式因稳定性限制（\(r \leq 0.5\) ）无法满足时，隐式可避免数值振荡。
高精度需求：隐式格式对空间、时间导数的离散更灵活，可结合高阶差分，在复杂边界、高梯度场（如地幔热对流、强热源冲击 ）模拟中，兼顾稳定性与精度。


---

## 6. 核心代码片段（可选）

```python
# 在此粘贴你实现的核心求解算法
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
地壳热扩散数值模拟 - 参考答案

使用显式差分格式求解一维热传导方程：
∂T/∂t = D * ∂²T/∂z²

边界条件:
- 地表 (z=0): T = A + B*sin(2πt/τ)
- 深度20m: T = 11°C

作者: 教学团队
日期: 2024
"""

import numpy as np
import matplotlib.pyplot as plt

# 物理常数
D = 0.1  # 热扩散率 (m^2/day)
A = 10.0  # 年平均地表温度 (°C)
B = 12.0  # 地表温度振幅 (°C)
TAU = 365.0  # 年周期 (days)
T_BOTTOM = 11.0  # 20米深处温度 (°C)
T_INITIAL = 10.0  # 初始温度 (°C)
DEPTH_MAX = 20.0  # 最大深度 (m)


def solve_earth_crust_diffusion(h=1.0, a=1.0, M=21, N=366, years=10):
    """
    求解地壳热扩散方程 (显式差分格式)
    
    参数:
        h (float): 空间步长 (m)
        a (float): 时间步长比例因子
        M (int): 深度方向网格点数
        N (int): 时间步数
        years (int): 总模拟年数
    
    返回:
        tuple: (depth_array, temperature_matrix)
            - depth_array (ndarray): 深度数组 (m)
            - temperature_matrix (ndarray): 温度矩阵 [time, depth]
    """
    # 计算稳定性参数
    r = h * D / a**2
    print(f"稳定性参数 r = {r:.4f}")
    
    # 初始化温度矩阵
    T = np.zeros((M, N)) + T_INITIAL
    T[-1, :] = T_BOTTOM  # 底部边界条件
    
    # 时间步进循环
    for year in range(years):
        for j in range(1, N-1):
            # 地表边界条件
            T[0, j] = A + B * np.sin(2 * np.pi * j / TAU)
            
            # 显式差分格式
            T[1:-1, j+1] = T[1:-1, j] + r * (T[2:, j] + T[:-2, j] - 2*T[1:-1, j])
    
    # 创建深度数组
    depth = np.arange(0, DEPTH_MAX + h, h)
    
    return depth, T


def plot_seasonal_profiles(depth, temperature, seasons=[90, 180, 270, 365]):
    """
    绘制季节性温度轮廓
    
    参数:
        depth (ndarray): 深度数组
        temperature (ndarray): 温度矩阵
        seasons (list): 季节时间点 (days)
    """
    plt.figure(figsize=(10, 8))
    
    # 绘制各季节的温度轮廓
    for i, day in enumerate(seasons):
        plt.plot(depth, temperature[:, day], 
                label=f'Day {day}', linewidth=2)
    plt.xlabel('Depth (m)')
    plt.ylabel('Temperature (°C)')
    plt.title('Seasonal Temperature Profiles')
    plt.grid(True)
    plt.legend()
    
    plt.show()


if __name__ == "__main__":
    # 运行模拟
    depth, T = solve_earth_crust_diffusion()
    
    # 绘制季节性温度轮廓
    plot_seasonal_profiles(depth, T)
```

